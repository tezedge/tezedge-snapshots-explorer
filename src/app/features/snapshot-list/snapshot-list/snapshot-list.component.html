<div class="flex-row flex-center align-center margin-top-10 p-absolute w-100vw h-100vh foreground-7"
     *ngIf="!snapshotData">Loading ...
</div>
<div fxFlex.gt-md="65px" fxFlex.lt-lg="170px" class="p-relative border-bottom" *ngIf="snapshotData">
  <div fxLayout.lt-lg="column" fxLayout.gt-md="row" class="title-row flex-between w-100 align-center">
    <h2 class="margin-remove">TezEdge Snapshots</h2>
    <div class="flex-row f-12 align-center foreground-4 flex-wrap">
      <div class="flex-row align-center">
        <span class="margin-right-10">Network</span>
        <div class="chip pointer text-capitalize margin-right-10"
             [class.active]="networkFilter.includes(network)"
             (click)="filterByNetwork(network)"
             *ngFor="let network of snapshotData.networks; let i=index">
          <mat-icon [style.width.px]="networkFilter.includes(network) ? 12 : 0"
                    svgIcon="check-circle"
                    class="icon-12 margin-right-5"></mat-icon>
          <div class="flex-row flex-center filter-text">{{ network }}</div>
        </div>
      </div>
      <div class="flex-row align-center">
        <span class="margin-right-10">Storage</span>
        <div class="chip pointer text-capitalize margin-right-10"
             [class.active]="contextFilter.includes(context)"
             (click)="filterByContext(context)"
             *ngFor="let context of snapshotData.contexts; let i=index">
          <mat-icon [style.width.px]="contextFilter.includes(context) ? 12 : 0"
                    svgIcon="check-circle"
                    class="icon-12 margin-right-5"></mat-icon>
          <div class="flex-row flex-center filter-text">{{ context }}</div>
        </div>
      </div>
      <div class="flex-row align-center">
        <span class="margin-right-10">Type</span>
        <div *ngFor="let extension of snapshotData.fileExtensions; let i=index"
             class="chip pointer text-capitalize margin-right-10"
             [class.active]="fileExtensionFilter.includes(extension)"
             (click)="filterByExtension(extension)">
          <mat-icon [style.width.px]="fileExtensionFilter.includes(extension) ? 12 : 0"
                    svgIcon="check-circle"
                    class="icon-12 margin-right-5"></mat-icon>
          <div class="flex-row flex-center filter-text">{{ extension }}</div>
        </div>
      </div>
    </div>
    <button class="theme-switcher p-absolute f-12 margin-top-5 border-remove pointer flex-row align-center flex-center"
            (click)="changeTheme(activeTheme === 'dark' ? 'light' : 'dark')">
      <mat-icon *ngIf="activeTheme === 'dark'"
                class="f-12 icon-16" svgIcon="sunny"></mat-icon>
      <mat-icon *ngIf="activeTheme === 'light'"
                class="f-12 icon-16" svgIcon="night"></mat-icon>
    </button>
  </div>
</div>

<div *ngIf="snapshotData" fxFlex.gt-md="calc(100% - 65px)" fxFlex.lt-lg="calc(100% - 170px)">
  <div class="snapshots-container w-100 foreground overflow-y-scroll h-100">
    <div class="snapshot-item-wrapper w-100 flex-column align-start">
      <div *ngFor="let snapshot of snapshotData.snapshots; let i=index"
           class="snapshot-item w-100 border border-rad-4">
        <div class="name text-break-all font-600 border-bottom">{{ snapshot.fileName }}</div>
        <div class="snapshot-content flex-column f-14 foreground">
          <div class="grid-like">
            <span class="foreground-4 margin-right-10">Network:</span>
            <span>{{ snapshot.network }}</span>
          </div>
          <div class="grid-like">
            <span class="foreground-4 margin-right-10">Storage:</span>
            <span>{{ snapshot.context }}</span>
          </div>
          <div class="grid-like">
            <span class="foreground-4 margin-right-10">Type:</span>
            <span>{{ snapshot.fileExtension }}</span>
          </div>
          <div class="grid-like">
            <span class="foreground-4 margin-right-10">Date:</span>
            <span>{{ snapshot.datetime }}</span>
          </div>
          <div class="grid-like">
            <span class="foreground-4 margin-right-10">Block hash:</span>
            <span class="text-break-all">{{ snapshot.hash }}</span>
          </div>
          <div class="grid-like">
            <span class="foreground-4 margin-right-10">Size:</span>
            <span>{{ snapshot.size / 1073741824 | number: '1.2-2' }} GB</span>
          </div>
          <div class="grid-like">
            <span class="foreground-4 margin-right-10">Download link:</span>
            <span>
              <a (click)="$event.stopPropagation()"
                 [href]="API + '/' + snapshot.network + '/' + snapshot.context + '/' + snapshot.fileExtension + '/' + snapshot.fileName"
                 class="text-break-all">{{ snapshot.fileName }}</a>
            </span>
          </div>
          <div class="clone-sample margin-top-10 padding-10 f-12 flex-column align-start">
            <div class="code text-break-all">
              <div class="foreground-4"># Download and import the snapshot</div>
              <div class="foreground-9 flex-row align-center">
                <div #code1>
                  light-node import-snapshot
                  --from {{ API + '/' + snapshot.network + '/' + snapshot.context + '/' + snapshot.fileExtension + '/' + snapshot.fileName }}
                </div>
                <span class="flex-row copy-button border-rad-2 pointer flex-row align-center flex-center margin-left-10"
                      [cdkCopyToClipboard]="code1.textContent"
                      (click)="copyToClipboard()"
                      matTooltip="Copy to clipboard">
                  <mat-icon svgIcon="clipboard" class="icon-background-surface-strong icon-14"></mat-icon>
                </span>
              </div>
              <br>
              <br>
              <div class="foreground-4"># Run tezedge</div>
              <div class="foreground-9 flex-row align-center">
                <div #code2>
                  light-node --network {{ snapshot.networkFromName }} --tezos-context-storage {{ snapshot.context }}
                </div>
                <span class="flex-row copy-button border-rad-2 pointer flex-row align-center flex-center margin-left-10"
                      [cdkCopyToClipboard]="code2.textContent"
                      (click)="copyToClipboard()"
                      matTooltip="Copy to clipboard">
                  <mat-icon svgIcon="clipboard" class="icon-background-surface-strong icon-14"></mat-icon>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
